<div class="page">
  <h1>Resident Live Chat</h1>

    <div class="chat-box" #chatBox>
    <ng-container *ngFor="let m of (messages$ | async); trackBy: trackByTs">
        <div *ngIf="m.kind === 'system'" class="system">
        {{ m.text }} â€¢ {{ m.ts | date:'shortTime' }}
        </div>

        <div *ngIf="m.kind === 'chat'" class="bubble" [class.mine]="m.username === myUsername">
        <div class="meta">
            <span class="user">{{ m.username }}</span>
            <span class="time">{{ m.ts | date:'shortTime' }}</span>
        </div>
        <div class="text">{{ m.text }}</div>
        </div>
    </ng-container>
    </div>

  <form class="form" (ngSubmit)="submit()">
    <input
      class="input"
      name="username"
      placeholder="Username"
      [(ngModel)]="username"
      [disabled]="!!myUsername"
      required
    />

    <input
      class="input"
      name="message"
      placeholder="Type a message..."
      [(ngModel)]="message"
      required
    />

    <button class="btn" type="submit" [disabled]="!username.trim() || !message.trim()">
      Send
    </button>
  </form>
</div>
